SELECT 
    job_title_short,
    CASE
        WHEN job_location = 'Anywhere' THEN 'Remote'
        WHEN job_location LIKE '%Germany%' THEN 'Local'
        ELSE 'Onsite'
    END AS job_location_mod
FROM 
    job_postings_fact;


SELECT 
    COUNT(job_id),
    CASE
        WHEN job_location = 'Anywhere' THEN 'Remote'
        WHEN job_location LIKE '%Germany%' THEN 'Local'
        ELSE 'Onsite'
    END AS location_category
FROM 
    job_postings_fact
WHERE job_title_short = 'Data Analyst'
GROUP BY 
    location_category;

/* From the job_postings_fact table, categorize the salaries from job postings 
that are data analyst jobs and who have a yearly salary information. 
Put salary into 3 different categories:

If the salary_year_avg is greater than $100,000 then return ‘high salary’.
If the salary_year_avg is between $60,000 and $99,999 return ‘Standard salary’.
If the salary_year_avg is below $60,000 return ‘Low salary’.
Also order from the highest to lowest salaries.
Hint:
In SELECT retrieve these columns: job_id, job_title, salary_year_avg, and a new column for the salary category.
CASE Statement: use to categorize salary_year_avg into 'High salary', 'Standard salary', or 'Low salary'.
If the salary is over $100,000, it's a High salary.
For salaries between $60,000 and $99,999, assign Standard salary.
Any salary below $60,000 should be marked as Low salary.
FROM the job_postings_fact table.
WHERE statement
Exclude records without a specified salary_year_avg.
Focus on job_title_short that exactly matches 'Data Analyst'.
use ORDER BY to sort by salary_year_avg in descending order to start with the highest salaries first. */

SELECT
    job_id,
    job_title,
    job_title_short,
    salary_year_avg,
    CASE
        WHEN salary_year_avg > 100000 THEN 'High Salary'
        WHEN salary_year_avg BETWEEN 60000 AND 99999 THEN 'Standard Salary'
        WHEN salary_year_avg < 60000 THEN 'Low Salary'
    END AS Salary_categories
FROM 
    job_postings_fact
WHERE
    job_title_short = 'Data Analyst' AND salary_year_avg IS NOT NULL
ORDER BY salary_year_avg DESC;

/* Count the number of unique companies that offer work from home (WFH) versus those requiring work to be on-site. 
Use the job_postings_fact table to count and compare the distinct companies based on their WFH policy (job_work_from_home).
Hint:
Use COUNT with DISTINCT to find unique values.
CASE WHEN statements to separate companies based on their WFH policy.
The data will be from the job_postings_fact table. */

SELECT *
FROM job_postings_fact
LIMIT 10000

SELECT
    COUNT(DISTINCT CASE WHEN job_work_from_home = TRUE THEN company_id END) AS wfh_companies,
    COUNT(DISTINCT CASE WHEN job_work_from_home = FALSE THEN company_id END) AS non_wfh_companies
FROM job_postings_fact;

/* Write a query that lists all job postings with their job_id, salary_year_avg, and two additional 
columns using CASE WHEN statements called: experience_level and remote_option. Use the job_postings_fact table.

For experience_level, categorize jobs based on keywords found in their titles (job_title) as 'Senior', 'Lead/Manager', 
'Junior/Entry', or 'Not Specified'. Assume that certain keywords in job titles (like "Senior", "Manager", "Lead", "Junior", or "Entry") 
can indicate the level of experience required. ILIKE should be used in place of LIKE for this.
NOTE: Use ILIKE in place of how you would normally use LIKE ; ILIKE is a command in SQL, specifically used in PostgreSQL. 
It performs a case-insensitive search, similar to the LIKE command but without sensitivity to case.
For remote_option, specify whether a job offers a remote option as either 'Yes' or 'No', based on job_work_from_home column.
Hint:
Use CASE WHEN to categorize data based on conditions.
Look for specific words that indicate job levels, like "Senior", "Manager", "Lead", "Junior", or "Entry". Use ILIKE 
to ensure the search for keywords is not case-sensitive.
For the remote work option based on job_work_from_home column and look at the boolean value in this column. */

SELECT
    job_id,
    salary_year_avg,
    CASE 
        WHEN job_title ILIKE '%Senior%' THEN 'Senior'
        WHEN job_title ILIKE '%Manager%' OR job_title ILIKE '%Lead%' THEN 'Manager/Lead'
        WHEN job_title ILIKE '%Junior%' OR job_title ILIKE '%Entry%' THEN 'Junior/Entry'
        ELSE 'Not Specified'
    END AS experience_level,
    CASE 
        WHEN job_work_from_home = TRUE THEN 'Yes'
        ELSE 'NO'
    END AS remote_option
FROM
    job_postings_fact
WHERE salary_year_avg IS NOT NULL
ORDER BY job_id;
